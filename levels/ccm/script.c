#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"

#include "game/level_update.h"

#include "levels/scripts.h"

#include "actors/common1.h"

/* Fast64 begin persistent block [includes] */
/* Fast64 end persistent block [includes] */

#include "make_const_nonconst.h"
#include "levels/ccm/header.h"

/* Fast64 begin persistent block [scripts] */
/* Fast64 end persistent block [scripts] */

const LevelScript level_ccm_entry[] = {
	INIT_LEVEL(),
	LOAD_YAY0(0x07, _ccm_segment_7SegmentRomStart, _ccm_segment_7SegmentRomEnd), 
	LOAD_YAY0_TEXTURE(0x09, _snow_yay0SegmentRomStart, _snow_yay0SegmentRomEnd), 
	LOAD_YAY0(0x0B, _effect_yay0SegmentRomStart, _effect_yay0SegmentRomEnd), 
	LOAD_YAY0(0x0A, _ccm_skybox_yay0SegmentRomStart, _ccm_skybox_yay0SegmentRomEnd), 
	LOAD_YAY0(0x05, _group7_yay0SegmentRomStart, _group7_yay0SegmentRomEnd), 
	LOAD_RAW(0x0C, _group7_geoSegmentRomStart, _group7_geoSegmentRomEnd), 
	LOAD_YAY0(0x06, _group16_yay0SegmentRomStart, _group16_yay0SegmentRomEnd), 
	LOAD_RAW(0x0D, _group16_geoSegmentRomStart, _group16_geoSegmentRomEnd), 
	LOAD_YAY0(0x08, _common0_yay0SegmentRomStart, _common0_yay0SegmentRomEnd), 
	LOAD_RAW(0x0F, _common0_geoSegmentRomStart, _common0_geoSegmentRomEnd), 
	ALLOC_LEVEL_POOL(),
	MARIO(MODEL_MARIO, 0x00000001, bhvMario), 
	JUMP_LINK(script_func_global_1), 
	JUMP_LINK(script_func_global_8), 
	JUMP_LINK(script_func_global_17), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_03, ccm_geo_00042C), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_04, ccm_geo_00045C), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_05, ccm_geo_000494), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_06, ccm_geo_0004BC), 
	LOAD_MODEL_FROM_GEO(MODEL_LEVEL_GEOMETRY_07, ccm_geo_0004E4), 
	LOAD_MODEL_FROM_GEO(MODEL_CCM_CABIN_DOOR, cabin_door_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_CCM_SNOW_TREE, snow_tree_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_CCM_ROPEWAY_LIFT, ccm_geo_0003D0), 
	LOAD_MODEL_FROM_GEO(MODEL_CCM_SNOWMAN_BASE, ccm_geo_0003F0), 
	LOAD_MODEL_FROM_GEO(MODEL_CCM_SNOWMAN_HEAD, ccm_geo_00040C), 

	/* Fast64 begin persistent block [level commands] */
	/* Fast64 end persistent block [level commands] */

	AREA(1, ccm_area_1),
		WARP_NODE(0x0A, LEVEL_CCM, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF0, LEVEL_CCM, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF1, LEVEL_CCM, 0x01, 0xF1, WARP_NO_CHECKPOINT),
		INSTANT_WARP(0x00, 0x02, 0, 18000, 0),
		OBJECT(MODEL_BSM_POINT_BALLOON, -5616, -5763, 4697, 0, 0, 0, 0x00040000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -8566, 10956, 20409, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -5316, 8227, -4448, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -7716, 8935, 5282, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -6866, 10956, 20409, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -7716, 9537, 12158, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -8147, 6989, -985, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 3234, 5812, -1148, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 5784, 4897, -5748, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -1205, 5857, -5258, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 1479, 5857, -2689, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 994, 4897, -7748, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 2192, 3712, -14348, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 3372, 3712, -14348, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -7716, 9222, 8558, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 7996, 1012, -28341, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 8664, 1162, -27748, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 6600, 2489, -24080, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 1230, 689, -23730, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 2784, 2662, -20648, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -216, -3038, -8198, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 2770, 4577, -11948, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 8135, -1087, -18262, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 27, -4418, -570, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -5227, -5498, 1240, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -7716, 10570, 17093, 0, 0, 0, 0x00020000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 5784, 4897, -6548, 0, 0, 0, 0x00020000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 1184, 2872, -17718, 0, 0, 0, 0x00020000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 4384, 2872, -17718, 0, 0, 0, 0x00020000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 4400, 240, -19700, 0, 0, 0, 0x00020000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 5470, -1265, -15410, 0, 0, 0, 0x00020000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 59, -4505, 391, 0, 0, 0, 0x00020000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -545, -4603, 1043, 0, 0, 0, 0x00030000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -8616, 8717, 3352, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -8391, 9635, 13858, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -8391, 9005, 6755, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -9614, 9849, 16300, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -9614, 9992, 17937, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -5817, 9992, 17937, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -5817, 9849, 16300, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -7041, 9635, 13858, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -9714, 9922, 17137, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -5714, 9922, 17137, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -7041, 9005, 6755, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -8616, 7016, 2, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -7241, 6854, -1448, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -8391, 9320, 10358, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -7041, 9320, 10358, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -3816, 6707, -1448, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -5441, 6768, -1448, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -6816, 8721, 3382, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -6816, 8303, -2898, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -6416, 8256, -3998, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -6816, 8425, -898, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -6816, 8564, 1202, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 5409, 4935, -1548, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 5784, 4889, -3309, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 5784, 4868, -4909, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -187, 4847, -7748, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 2166, 4847, -7748, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -316, 5807, -4407, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 578, 5807, -3551, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 1015, 3662, -14348, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 4546, 3662, -14348, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 8895, 1262, -27092, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 7168, 812, -28496, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 3855, 512, -28334, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 4288, 2162, -23953, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 3301, 2312, -23195, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 2784, 2462, -22148, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 2133, 362, -26736, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 1293, 212, -24808, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 3718, -388, -19829, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 5075, -553, -19751, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 2330, -238, -20292, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 6325, -753, -19850, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 7762, -1085, -18716, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 8119, -1192, -17631, 0, 0, 0, 0x00010000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -7716, 10931, 20409, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -457, -4363, -1186, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 7887, -1377, -17114, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -4333, -5408, 580, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -52, -2788, -11208, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 4325, -2038, -15321, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 3210, -2188, -15172, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, 2037, -2338, -14688, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -187, -2938, -9760, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -5565, -5733, 2208, 0, 0, 0, 0x00000000, bhvPointBalloon),
		OBJECT(MODEL_BSM_POINT_BALLOON, -5623, -5913, 3395, 0, 0, 0, 0x00000000, bhvPointBalloon),
		MARIO_POS(0x01, -180, -7707, 11448, 28317),
		OBJECT(MODEL_NONE, -7707, 11448, 28317, 0, -180, 0, 0x000A0000, bhvSpinAirborneWarp),
		OBJECT(MODEL_NONE, -7707, 11448, 28317, 0, -180, 0, 0x00F00000, bhvAirborneStarCollectWarp),
		OBJECT(MODEL_NONE, -7707, 11448, 28317, 0, -180, 0, 0x00F10000, bhvDeathWarp),
		TERRAIN(ccm_area_1_collision),
		ROOMS(ccm_area_1_collision_rooms),
		MACRO_OBJECTS(ccm_area_1_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_WATER),
		TERRAIN_TYPE(TERRAIN_SLIDE),
		/* Fast64 begin persistent block [area commands] */
		SET_BACKGROUND_MUSIC_WITH_REVERB(0x00, SEQ_LEVEL_WATER, 0x04, 0x04),
		SET_ECHO(0x10, 0x10),
		/* Fast64 end persistent block [area commands] */
	END_AREA(),

	AREA(2, ccm_area_2),
		WARP_NODE(0x0A, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF0, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF1, LEVEL_BOB, 0x01, 0xF1, WARP_NO_CHECKPOINT),
		INSTANT_WARP(0x00, 0x03, 1000, 15300, -44000),
		OBJECT(MODEL_NONE, -10458, 9889, 9711, 0, 35, 0, 0x000A0000, bhvSpinAirborneWarp),
		OBJECT(MODEL_NONE, -10458, 9889, 9711, 0, 35, 0, 0x00F00000, bhvAirborneStarCollectWarp),
		OBJECT(MODEL_NONE, -10458, 9889, 9711, 0, 35, 0, 0x00F10000, bhvDeathWarp),
		TERRAIN(ccm_area_2_collision),
		ROOMS(ccm_area_2_collision_rooms),
		MACRO_OBJECTS(ccm_area_2_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_SNOW),
		TERRAIN_TYPE(TERRAIN_SLIDE),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),

	AREA(3, ccm_area_3),
		WARP_NODE(0x0A, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF0, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF1, LEVEL_BOB, 0x01, 0xF1, WARP_NO_CHECKPOINT),
		INSTANT_WARP(0x00, 0x04, 0, 14000, 0),
		OBJECT(MODEL_NONE, -7500, 3621, -17300, 0, -180, 0, 0x000A0000, bhvSpinAirborneWarp),
		OBJECT(MODEL_NONE, -7500, 3621, -17300, 0, -180, 0, 0x00F00000, bhvAirborneStarCollectWarp),
		OBJECT(MODEL_NONE, -7500, 3621, -17300, 0, -180, 0, 0x00F10000, bhvDeathWarp),
		TERRAIN(ccm_area_3_collision),
		ROOMS(ccm_area_3_collision_rooms),
		MACRO_OBJECTS(ccm_area_3_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_SNOW),
		TERRAIN_TYPE(TERRAIN_SLIDE),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),

	AREA(4, ccm_area_4),
		WARP_NODE(0x0A, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF0, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF1, LEVEL_BOB, 0x01, 0xF1, WARP_NO_CHECKPOINT),
		OBJECT(MODEL_NONE, 0, 0, 0, 0, 0, 0, 0x000A0000, bhvSpinAirborneWarp),
		OBJECT(MODEL_NONE, 0, 0, 0, 0, 0, 0, 0x00F00000, bhvAirborneStarCollectWarp),
		OBJECT(MODEL_NONE, 0, 0, 0, 0, 0, 0, 0x00F10000, bhvDeathWarp),
		TERRAIN(ccm_area_4_collision),
		ROOMS(ccm_area_4_collision_rooms),
		MACRO_OBJECTS(ccm_area_4_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_SNOW),
		TERRAIN_TYPE(TERRAIN_SLIDE),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),

	FREE_LEVEL_POOL(),
	MARIO_POS(0x01, -180, -7707, 11448, 28317),
	CALL(0, lvl_init_or_update),
	CALL_LOOP(1, lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(1),
	EXIT(),
};
